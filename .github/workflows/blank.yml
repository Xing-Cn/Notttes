name: 额の自动化程序壹号

on:
  push:
    branches: [ main ]

permissions:
  contents: write

jobs:
  check-and-update:
    runs-on: ubuntu-latest
    
    steps:
    - name: 获取仓库代码
      uses: actions/checkout@v4
      
    - name: 更新README统计
      run: |
        # 获取统计信息
        NOTE_COUNT=$(find . -name "*.md" | wc -l)
        
        # 直接在命令中生成时间，避免变量问题
        echo "" >> README.md
        echo "### 🚀 实时统计" >> README.md
        echo "> 最后同步: $(date '+%Y-%m-%d %H:%M')" >> README.md
        echo "" >> README.md
        echo "- 笔记总数: $NOTE_COUNT 篇" >> README.md
        echo "- 检查状态: ✅运行正常" >> README.md
        echo "" >> README.md
        echo "*auto updata*" >> README.md
        
    - name: 提交更改
      run: |
        git config --local user.email "a138196861120@163.com"
        git config --local user.name "Xing-Cn"
        git add README.md
        git commit -m "📊 更新统计" || exit 0
        git push
